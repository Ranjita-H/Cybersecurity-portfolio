# ğŸ¦  Malware Analysis: VirusTotal Investigations & YARA Rule Writing  

This repository documents my **hands-on experience** in **malware analysis**, including:  
- **Using VirusTotal** for **hash, domain, and URL investigations**.  
- **Writing YARA rules** to detect malware patterns.  

---

## ğŸ” **VirusTotal Investigations**  

### **ğŸ”¹ What is VirusTotal?**  
[VirusTotal](https://www.virustotal.com/) is an online **malware scanning and threat intelligence** platform that allows users to analyze:  
âœ… **File hashes** (SHA256, MD5)  
âœ… **Suspicious URLs & domains**  
âœ… **IP addresses linked to malicious activity**  

### **ğŸ› ï¸ Steps to Investigate Malware with VirusTotal**  
1. **Visit VirusTotal** â†’ [https://www.virustotal.com/](https://www.virustotal.com/)  
2. **Upload a file OR enter an IOC (hash, URL, IP)** in the search bar.  
3. **Analyze the results**, focusing on:  
   - **Detection ratio** (number of AV engines detecting it as malicious).  
   - **File behavior** (execution, registry changes, network connections).  
   - **Community insights** (comments from researchers).  
4. **Extract Indicators of Compromise (IOCs)** and use them in further threat hunting.  

### ğŸ“Œ **Example Use Case**  
You receive a **suspicious email attachment** named `invoice.pdf.exe`.  
- **VirusTotal scan** reveals the file communicates with a **C2 server** linked to a known **RAT (Remote Access Trojan)**.  
- You **extract the file hash and C2 IP** to block it in security systems.  

---

## ğŸ›¡ï¸ **YARA Rule Writing for Malware Detection**  

### **ğŸ”¹ What is YARA?**  
[YARA](https://virustotal.github.io/yara/) (Yet Another Recursive Acronym) is a **pattern-matching tool** used to detect and classify malware based on:  
âœ… **File characteristics** (strings, hex patterns).  
âœ… **Malware family traits** (C2 communication, obfuscation techniques).  
âœ… **Behavioral indicators** (registry changes, process injections).  

### **ğŸ› ï¸ Writing a Simple YARA Rule**  
```yara
rule Malicious_File_Detection  
{  
    meta:  
        author = "Ranjita Hukkeri"  
        description = "Detects suspicious malware patterns in executables"  
        date = "2025-02-19"  
    strings:  
        $malicious_string1 = "h4ck3d"  
        $malicious_string2 = "suspicious.exe"  
        $hex_pattern = {6A 40 68 00 30 00 00 6A 14 8D 91}  
    condition:  
        any of them  
}



---


### ** Explanation of the Rule**  
- **Meta section** â€“ Defines **author, description, and date** for tracking.  
- **Strings section** â€“ Contains **text and hex-based patterns** found in malware.  
- **Condition section** â€“ Triggers an alert if **any of the patterns match**.  

### **ğŸ› ï¸ Testing the YARA Rule**  
1. Install YARA:  
   ``` 
   sudo apt install yara  # (Linux)  
   choco install yara  # (Windows)  
 
   ```
2. Run the rule against a **sample file**:  
   ```
   yara my_rule.yar sample.exe  
   ```
3. If a match is found, **the file is flagged as malicious**.  

### ğŸ“Œ **Example Use Case**  
A **SOC team finds a suspicious executable** (`payload.exe`).  
- Writing a **YARA rule** based on the malwareâ€™s unique hex pattern **detects variants of the same malware family**.  

---

##  **Conclusion & Next Steps**  
âœ”ï¸ **VirusTotal** helps analyze malware **hashes, domains, and IPs**.  
âœ”ï¸ **YARA rules** provide a **custom way to detect threats** based on unique patterns.  

```
